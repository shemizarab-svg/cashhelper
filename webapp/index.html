<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Budget Tracker</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+SC:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css?v=16.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <div class="desktop-wrapper">
        <div class="main-frame">
            <div class="scrollable-area">
                
                <div id="month-selector-panel" class="gold-section top-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 5px;">
                        <span class="gold-label">–ú–µ—Å—è—Ü:</span>
                        <div style="display:flex; gap: 5px;">
                            <button id="bg-change-btn" class="theme-btn" onclick="changeBackgroundConfig()" style="display:none;">üñºÔ∏è –§–æ–Ω</button>
                            <button class="theme-btn" onclick="toggleTheme()">üé® –°—Ç–∏–ª—å</button>
                        </div>
                    </div>
                    
                    <select id="month-select" class="wow-input" onchange="changeMonth()">
                        <option value="Jan">–Ø–Ω–≤–∞—Ä—å</option>
                        <option value="Feb">–§–µ–≤—Ä–∞–ª—å</option>
                        <option value="Mar">–ú–∞—Ä—Ç</option>
                        <option value="Apr">–ê–ø—Ä–µ–ª—å</option>
                        <option value="May">–ú–∞–π</option>
                        <option value="Jun">–ò—é–Ω—å</option>
                        <option value="Jul">–ò—é–ª—å</option>
                        <option value="Aug">–ê–≤–≥—É—Å—Ç</option>
                        <option value="Sep">–°–µ–Ω—Ç—è–±—Ä—å</option>
                        <option value="Oct">–û–∫—Ç—è–±—Ä—å</option>
                        <option value="Nov">–ù–æ—è–±—Ä—å</option>
                        <option value="Dec">–î–µ–∫–∞–±—Ä—å</option>
                    </select>
                </div>

                <div id="monthly-view">
                    
                    <details class="gold-section settings-section" style="margin-bottom: 15px;">
                        <summary class="settings-summary">‚öôÔ∏è –õ–∏–º–∏—Ç—ã</summary>
                        <div class="settings-content">
                            <p style="font-size: 12px; color: #aaa; text-align: center; margin: 5px 0;">
                                –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç. –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Å—É–º–º–∞ —Å—Ç–∞–Ω–µ—Ç –∫—Ä–∞—Å–Ω–æ–π.
                            </p>
                            <div id="limits-list-container"></div>
                        </div>
                    </details>

                    <div class="gold-section">
                        <span class="gold-label">–î–æ—Ö–æ–¥:</span>
                        <div class="gold-value-container">
                            <span class="gold-icon-big"></span>
                            <input type="number" id="income-input" class="invisible-input" placeholder="0" onchange="manualIncomeEdit()">
                            <button class="add-income-btn" onclick="addMoreIncome()">+</button>
                        </div>
                    </div>

                    <div class="chart-box">
                        <div class="chart-wrapper">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    <div class="gold-section remaining-section">
                        <span class="gold-label">–û—Å—Ç–∞—Ç–æ–∫:</span>
                        <div class="gold-value-container">
                            <span class="gold-icon-big"></span>
                            <span id="remaining-amount" class="gold-text">0</span>
                        </div>
                    </div>

                    <div class="control-panel-wrapper">
                        <div class="new-category-panel">
                            <div class="input-row">
                                <input type="text" id="new-cat-name" class="wow-input" placeholder="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è...">
                                <button onclick="addNewCategory()" class="wow-btn small-btn">–°–æ–∑–¥–∞—Ç—å</button>
                            </div>
                        </div>

                        <div class="spend-panel">
                            <div class="panel-header">–ë—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—Ö–æ–¥</div>
                            <div class="input-row">
                                <select id="category-select" class="wow-input"></select>
                            </div>
                            <div class="input-row">
                                <input type="number" id="amount" class="wow-input" placeholder="–°—É–º–º–∞...">
                                <button onclick="addExpense()" class="wow-btn spend-btn">–ü–æ—Ç—Ä–∞—Ç–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <div class="breakdown-panel">
                        <div class="panel-header">–°–ø–∏—Å–æ–∫ —Ç—Ä–∞—Ç</div>
                        <div id="breakdown-list"></div>
                    </div>
                </div>

                <div id="yearly-view" style="display: none;">
                    <div class="gold-section">
                        <span class="gold-label">–ù–∞–∫–æ–ø–ª–µ–Ω–∏—è –∑–∞ –≥–æ–¥:</span>
                        <div class="gold-value-container">
                            <span class="gold-icon-big"></span>
                            <span id="year-total-savings" class="gold-text">0</span>
                        </div>
                    </div>
                    <div class="chart-box">
                        <div class="panel-header">–¢—Ä–∞—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</div>
                        <div class="chart-wrapper"><canvas id="yearRadarChart"></canvas></div>
                    </div>
                    <div class="chart-box">
                        <div class="panel-header">–°–∞–º—ã–π –∑–∞—Ç—Ä–∞—Ç–Ω—ã–π –º–µ—Å—è—Ü</div>
                        <div class="chart-wrapper"><canvas id="yearBarChartExpenses"></canvas></div>
                    </div>
                    <div class="chart-box">
                        <div class="panel-header">–¢—Ä–µ–Ω–¥ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π</div>
                        <div class="chart-wrapper"><canvas id="yearBarChartSavings"></canvas></div>
                    </div>
                    <div class="breakdown-panel">
                        <div class="panel-header">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                        <div id="year-text-report" style="padding: 10px;"></div>
                    </div>
                </div>

                <div id="garage-view" style="display: none;">
                    
                    <div class="chart-box">
                        <div class="panel-header">–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è</div>
                        <div class="chart-wrapper" style="height: 200px;">
                            <canvas id="garageChart"></canvas>
                        </div>
                    </div>

                    <details class="gold-section settings-section" style="margin-bottom: 20px;">
                        <summary class="settings-summary">‚öôÔ∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –¢–û (–ö–ú)</summary>
                        <div class="settings-content">
                            <p style="font-size: 12px; color: #aaa; text-align: center; margin: 5px 0;">
                                –ù–∞—Å—Ç—Ä–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è.
                            </p>
                            <div id="garage-standards-container"></div>
                        </div>
                    </details>

                    <div class="control-panel-wrapper">
                        <div class="panel-header">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</div>
                        
                        <div class="input-row">
                            <input type="text" id="car-part-name" class="wow-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (Shell 5w40...)">
                        </div>

                        <div class="input-row">
                            <select id="car-part-type" class="wow-input" onchange="autoFillMileage()">
                                </select>
                            
                            <button class="wow-btn small-btn" style="width: 40px; font-size: 20px; padding: 0;" onclick="addGarageType()">+</button>
                            <button class="wow-btn small-btn" style="width: 40px; font-size: 20px; padding: 0; color: #ffd700; border-color: #ffd700;" onclick="editGarageType()">‚úé</button>
                            <button class="wow-btn small-btn" style="width: 40px; font-size: 16px; padding: 0; color: #ff4e4e; border-color: #ff4e4e;" onclick="deleteGarageType()">‚úñ</button>
                        </div>

                        <div class="input-row">
                            <input type="number" id="car-current-km" class="wow-input" placeholder="–ü—Ä–æ–±–µ–≥ —Å–µ–π—á–∞—Å (–∫–º)">
                            <input type="number" id="car-interval-km" class="wow-input" placeholder="–†–µ—Å—É—Ä—Å (–∫–º)">
                        </div>

                        <div class="input-row">
                            <input type="number" id="car-price" class="wow-input" placeholder="–¶–µ–Ω–∞">
                            <button onclick="addCarItem()" class="wow-btn spend-btn">–ó–∞–ø–∏—Å–∞—Ç—å</button>
                        </div>
                        <div style="font-size: 10px; color: #777; text-align: center; margin-top: 5px;">
                            * –¶–µ–Ω–∞ –¥–æ–±–∞–≤–∏—Ç—Å—è –≤ –±—é–¥–∂–µ—Ç "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"
                        </div>
                    </div>

                    <div class="breakdown-panel">
                        <div class="panel-header">–ñ—É—Ä–Ω–∞–ª (–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü)</div>
                        <div id="garage-list"></div>
                    </div>
                </div>

                <div id="user-id-display" style="text-align: center; color: #555; font-size: 10px; margin-top: 10px;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div class="bottom-spacer"></div>
            </div>

            <div class="bottom-nav">
                <button id="tab-month" class="nav-btn active" onclick="switchTab('month')">–ë—é–¥–∂–µ—Ç</button>
                <button id="tab-garage" class="nav-btn" onclick="switchTab('garage')">–ì–∞—Ä–∞–∂</button>
                <button id="tab-year" class="nav-btn" onclick="switchTab('year')">–ì–æ–¥</button>
            </div>
        </div>
    </div>

    <input type="file" id="file-input-main" accept="image/*" style="display: none;" onchange="handleFileUpload(this, 'main')">
    <input type="file" id="file-input-garage" accept="image/*" style="display: none;" onchange="handleFileUpload(this, 'garage')">

    <div id="bg-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 style="margin-top:0; color:#333;">–°–º–µ–Ω–∏—Ç—å —Ñ–æ–Ω</h3>
            <p style="font-size: 14px; color:#666; margin-bottom: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏:</p>
            
            <button class="wow-btn" style="width:100%; margin-bottom:10px;" onclick="triggerFile('main')">üì± –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω</button>
            <button class="wow-btn" style="width:100%; margin-bottom:10px;" onclick="triggerFile('garage')">üöó –ì–∞—Ä–∞–∂</button>
            
            <div style="border-top: 1px solid #ddd; margin: 15px 0;"></div>
            
            <button class="wow-btn small-btn" style="width:100%; border-color: #ff4e4e; color: #ff4e4e;" onclick="resetBackgrounds()">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç</button>
            <button class="wow-btn small-btn" style="width:100%; margin-top:10px; border:none; background:transparent;" onclick="closeBgModal()">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
    <script src="script.js?v=16.0"></script>
</body>
</html>